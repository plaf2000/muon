# Task 2: Muon Ablation Study Configuration

experiment:
  name: "task2_ablation"
  seed: 42
  device: "cuda"  # or "cpu"

dataset:
  name: "mnist"  # or "cifar10", "toy"
  root: "./data"
  batch_size: null  # null for full-batch training

model:
  type: "mlp"
  input_size: 784  # 28*28 for MNIST
  hidden_sizes: [128, 64]
  num_classes: 10

training:
  num_epochs: 100
  loss_fn: "cross_entropy"
  base_lr: 0.01

ablation:
  # Base Muon configuration
  base:
    ns_depth: 1
    use_rms: true
    use_orthogonalization: true
    weight_decay: 0.0
  
  # Variants to test
  variants:
    - name: "no_rms"
      ns_depth: 1
      use_rms: false
      use_orthogonalization: true
      weight_decay: 0.0
    
    - name: "no_orthogonalization"
      ns_depth: 1
      use_rms: true
      use_orthogonalization: false
      weight_decay: 0.0
    
    - name: "ns_depth_2"
      ns_depth: 2
      use_rms: true
      use_orthogonalization: true
      weight_decay: 0.0
    
    - name: "with_weight_decay"
      ns_depth: 1
      use_rms: true
      use_orthogonalization: true
      weight_decay: 0.01

metrics:
  track_loss: true
  track_accuracy: true
  track_lambda_max: true
  track_frequency: 1

output:
  save_dir: "./results/task2"
  save_frequency: 10
