# Task 3(A): Edge-of-Stability Configuration (multi-optimizer runs)

experiment:
  name: "task3_eos"
  seed: 42
  device: "auto"

dataset:
  name: "mnist"
  root: "./data"
  full_batch: true
  train_subset_size: 10000   # optional speedup

model:
  type: "mlp"
  config:
    input_size: 784
    hidden_sizes: [128, 64]
    num_classes: 10
    dropout: 0.0

training:
  num_epochs: 200
  loss_fn: "cross_entropy"

eos_analysis:
  track_frequency: 5

hessian:
  max_iter: 50
  tol: 1e-6

logging:
  wandb:
    enabled: true
    project: "muon"
    # entity: "your_wandb_username_or_team"  # optional

output:
  save_dir: "./results/task3"

# Run 3 separate W&B runs (one per optimizer)
optimizers:
  gd:
    type: "gd"
    config:
      lr: 0.01
      momentum: 0.0
      weight_decay: 0.0

  adamw:
    type: "adamw"
    config:
      lr: 0.001
      weight_decay: 0.01

  muon:
    type: "muon"
    config:
      lr: 0.02
      momentum: 0.95
      ns_depth: 5
      use_rms: true
      use_orthogonalization: true
      weight_decay: 0.0
      adamw_lr: 0.001
